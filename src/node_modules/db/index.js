"use strict";

const 
    AWS = require('aws-sdk')
  , _ = require('underscore')
  , tableDefinitions = require('./table-definitions')
  , config = require('config');


AWS.config.update({
    accessKeyId: process.env.accessKeyId,
    secretAccessKey: process.env.secretAccessKey,
    region: config.AWS.region,
    endpoint: config.AWS.endpoint
});

module.exports.dbConnection = function() {
  const dynamodb = new AWS.DynamoDB();
  return dynamodb;
}();

module.exports.documentClient = function() {
  const dynamodbClient = new AWS.DynamoDB.DocumentClient();
  return dynamodbClient;
}();

module.exports.tableDefinitions = tableDefinitions;

module.exports.getTableName = function(modelName) {
  return _.find(tableDefinitions, table => table.model === modelName).tableName;
}